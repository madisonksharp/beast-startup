<!DOCTYPE html>
<html lang="en">



<head>

  <meta charset="UTF-8" />
  <!-- Tell browsers not to scale the viewport automatically -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="output.css" rel="stylesheet">
  <title>BuddySystem</title>
  <link rel="icon" href="favicon.ico" />
</head>

<body class="min-h-screen flex flex-col w-full bg-bs-pale-pink items-center tracking-wider">
  <header class="flex w-full bg-bs-blue-purple justify-center items-center shadow-lg">
    <!--Username is the logged in user's username-->

    <nav class="w-full py-4 max-w-7xl mx-auto px-4">
      <div class="w-full flex items-center">
        <div class="space-x-4 w-full flex">
          <img class="h-10 w-10"
            src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSGpwoWte9xeY3146maAym8bs-9dh1HeXm_Xg&usqp=CAU">

          <a class=" text-bs-pale-pink font-sans text-2xl md:text-3xl font-bold lg:text-4xl" href="../index.html">Buddy
            System</a>
        </div>


        <div class="hidden md:flex items-center space-x-4">
          <!-- Menu items for larger screen -->
          <a class="text-white hover:text-bs-hot-pink" href="#">Home</a>
          <a class="text-white hover:text-bs-hot-pink" href="/user/feed.html">Feed</a>
          <a class="text-white hover:text-bs-hot-pink" href="/user/goals.html">Goals</a>
          <a class="text-white hover:text-bs-hot-pink" href="/user/profile.html">Profile</a>
        </div>
        <div class="md:hidden">
          <!-- Hamburger icon for small screens -->
          <button id="menu-toggle" class=" text-white focus:outline-none">
            <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
            </svg>
          </button>
        </div>
        <!--Mobile menu-->
        <div id="mobile-menu" class="md:hidden fixed top-0 left-0 w-full  bg-bs-blue-purple hidden duration-500">
          <div
            class=" text-2xl flex flex-col items-center h-full w-full p-4 justify-between text-bs-pale-pink space-y-3">
            <button id="menu-close" class="self-end  focus:outline-none">X</button>
            <a class="block hover:text-bs-hot-pink" href="#">Home</a>
            <a class="block hover:text-bs-hot-pink" href="/user/feed.html">Feed</a>
            <a class="block  hover:text-bs-hot-pink" href="/user/goals.html">Goals</a>
            <a class="block hover:text-bs-hot-pink pb-7 " href="/user/profile.html">Profile</a>
          </div>

        </div>
      </div>

    </nav>

  </header>

  <main class="flex flex-col flex-grow justify-center items-center mx-5 ">
    <div id="quote-div" class=" h-2/5 md:w-2/5 text-center">
      <!--Image-->
      <h2 class="text-gray-dark text-3xl">Achieving greatness isn't a solo mission-- it's a shared expedition!</h2>
    </div>
    <div class="w-11/12 mt-20 bg-bs-periwinkle/50 p-4 flex flex-col rounded-xl shadow-lg md:w-3/5">
      <form id="login-form" class=" flex flex-col space-y-6 text-gray-dark">
        <div class="flex flex-col space-y-3">
          <label for="username">Username</label>
          <input class="bg-bs-pale-pink appearance-none h-10 rounded-lg px-4 focus:outline-none focus:shadow-outline"
            type="text" id="username" placeholder="Your username here" />
        </div>
        <div class="flex flex-col space-y-3">
          <label for="password">Password</label>
          <input class="bg-bs-pale-pink appearance-none h-10 rounded-lg px-4 focus:outline-none focus:shadow-outline"
            type="password" id="password" placeholder="Your password here" />
        </div>
        <!-- Password text box -->
        <button id="log-button" type="submit"
          class="bg-bs-blue-purple py-3  rounded-lg shadow-lg text-bs-pale-pink">Login</button>
        <a id="reg-link" href="/register.html" class=" text-center underline">Create Account</a>
      </form>
      <!--register new account-->
      <form id="reg-form" class=" hidden flex flex-col space-y-6 text-gray-dark" method=" get" action="/user/feed.html">
        <div class="flex flex-col space-y-3">
          <label for="rusername">Username</label>
          <input class="bg-bs-pale-pink appearance-none h-10 rounded-lg px-4 focus:outline-none focus:shadow-outline"
            type="text" id="rusername" placeholder="Your username here" />
        </div>
        <div class="flex flex-col space-y-3">
          <label for="rname">Name</label>
          <input class="bg-bs-pale-pink appearance-none h-10 rounded-lg px-4 focus:outline-none focus:shadow-outline"
            type="text" id="rname" placeholder="Your name here" />
        </div>
        <div class="flex flex-col space-y-3">
          <label for="remail">Email</label>
          <input class="bg-bs-pale-pink appearance-none h-10 rounded-lg px-4 focus:outline-none focus:shadow-outline"
            type="text" id="remail" placeholder="Your email here" />
        </div>
        <div class="flex flex-col space-y-3">
          <label for="rpassword">Password</label>
          <input class="bg-bs-pale-pink appearance-none h-10 rounded-lg px-4 focus:outline-none focus:shadow-outline"
            type="password" id="rpassword" placeholder="Your password here" />
        </div>
        <!-- Password text box -->
        <button id="reg-button" type="submit"
          class="bg-bs-blue-purple py-3  rounded-lg shadow-lg text-bs-pale-pink">Create
          Account</button>
        <a id="log-link" href="/index.html" class=" text-center underline"> Already have an account? Login</a>
      </form>
    </div>
  </main>

  <footer class="flex justify-center h-20 bg-bs-pale-pink text-gray-dark/50 py-4 flex-shrink-0 space-x-4">
    <span class="text-reset">Madison Sharp</span>
    <p>â€¢</p>
    <a href="https://github.com/madisonksharp/startup.git" class="underline">GitHub</a>
  </footer>


  <script type="module">
    import { API } from './api.js';
    document.addEventListener('DOMContentLoaded', (event) => {

      API.setBaseURL(window.location.origin);

      function toggleLogin() {
        var loginForm = document.getElementById('login-form');
        var regForm = document.getElementById('reg-form');
        var quoteDiv = document.getElementById('quote-div');
        loginForm.classList.toggle('hidden');
        regForm.classList.toggle('hidden');
        quoteDiv.classList.toggle('hidden');

      }

      document.getElementById('menu-toggle').addEventListener('click', function () {
        var mobileMenu = document.getElementById('mobile-menu');

        mobileMenu.classList.toggle('hidden');


      });

      document.getElementById('menu-close').addEventListener('click', function () {
        var mobileMenu = document.getElementById('mobile-menu');

        mobileMenu.classList.toggle('hidden');


      });

      document.getElementById('reg-link').addEventListener('click', function (e) {
        e.preventDefault();
        toggleLogin();


      });
      document.getElementById('log-link').addEventListener('click', function (e) {
        e.preventDefault();
        toggleLogin();

      });

      document.getElementById('reg-button').addEventListener('click', async function (e) {

        let username = document.getElementById('rusername').value;
        let password = document.getElementById('rpassword').value;
        let name = document.getElementById('rname').value;
        let email = document.getElementById('remail').value;
        let profilePic = "";
        let success = await API.register(username, name, email, password, profilePic);

        if (!success) {
          //TODO: error
          console.log("register fail");
          e.preventDefault();
        } else {
          e.preventDefault();
          window.location.href = "/user/profile.html";
        };

      });

      document.getElementById('log-button').addEventListener('click', async function (e) {
        console.log("submit log");
        let username = document.getElementById('username').value;
        let password = document.getElementById('password').value;
        let success = await API.login(username, password);
        if (!success) {
          //TODO: error
          e.preventDefault();
        } else {
          e.preventDefault();
          window.location.href = "/user/feed.html";
        };


      });

    });


  </script>
</body>

</html>